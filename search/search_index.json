{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to my pages","text":""},{"location":"#unordered-list","title":"Unordered List","text":"<ul> <li>First Item</li> <li>Second Item</li> </ul>"},{"location":"#ordered-list","title":"Ordered List","text":"<ol> <li>First Entry</li> <li>Second Entry</li> </ol>"},{"location":"#emoji-test","title":"Emoji Test","text":"<p>I like to drink  after  I played </p>"},{"location":"LUKS-Fido2/","title":"Debian 13 (Trixie) with LUKS and hardware passkey","text":"<p>On this page I will explain, how to decrypt LUKS encrypted partition</p> <p>I've tested it on several virtual machines and also my laptop works with this setup. You can take this at your own risk. I don't take any responsability for misconfiguration on your side</p>"},{"location":"LUKS-Fido2/#prerequisites","title":"Prerequisites","text":"<ul> <li>Debian 13 setup with encryption</li> <li>Hardware fido2 Token (e.g.: yubikey, Token2)</li> </ul>"},{"location":"LUKS-Fido2/#find-partition","title":"Find Partition","text":"<p>First we need to find the encrypted filesystems. We will use <code>lsblk</code> to figure that out</p> Output of 'lsblk'<pre><code>nimda@trixie:~$ lsblk\nNAME                    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINTS\nsr0                      11:0    1  3,7G  0 rom   \nvda                     254:0    0   20G  0 disk  \n\u251c\u2500vda1                  254:1    0  966M  0 part  /boot\n\u251c\u2500vda2                  254:2    0    1K  0 part  \n\u2514\u2500vda5                  254:5    0 19,1G  0 part  \n  \u2514\u2500vda5_crypt          253:0    0   19G  0 crypt \n    \u251c\u2500trixie--vg-root   253:1    0   18G  0 lvm   /\n    \u2514\u2500trixie--vg-swap_1 253:2    0    1G  0 lvm   [SWAP]\nnimda@trixie:~$ \n</code></pre> <p>In this case we have <code>/dev/vda5</code></p>"},{"location":"LUKS-Fido2/#show-fido2-key","title":"Show fido2 key","text":"<p>Next action will be, to check, if fido2 token is found using <code>systemd-cryptenroll</code>command</p> Output of 'systemd-cryptenroll'<pre><code>nimda@trixie:~$ systemd-cryptenroll --fido2-device=list\nPATH         MANUFACTURER PRODUCT                  COMPATIBLE\n/dev/hidraw2 TOKEN2       FIDO2 Security Key(0026) \u2713\nnimda@trixie:~$ \n</code></pre> <p>Now, as we have all needed information, we can enroll the token</p>"},{"location":"LUKS-Fido2/#enroll","title":"Enroll","text":"Enrolling token<pre><code>nimda@trixie:~$ sudo systemd-cryptenroll /dev/vda5 --fido2-device=auto -fido2-with-client-pin=yes\n[sudo] Passwort f\u00fcr nimda: \n\ud83d\udd10 Please enter current passphrase for disk /dev/vda5: \u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022               \nInitializing FIDO2 credential on security token.\n\ud83d\udc46 (Hint: This might require confirmation of user presence on security token.)\n\ud83d\udd10 Please enter security token PIN: \u2022\u2022\u2022\u2022\u2022\u2022                  \nGenerating secret key on FIDO2 security token.\n\ud83d\udc46 In order to allow secret key generation, please confirm presence on security token.\nNew FIDO2 token enrolled as key slot 1.\nnimda@trixie:~$ \n</code></pre>"},{"location":"LUKS-Fido2/#checking","title":"Checking","text":"<p>To check, that the token was configured correctly, we can use the command</p> <p><code>sudo cryptsetup luksDump /dev/vda5</code></p> Output of 'cryptsetup luksDump /dev/vda5'<pre><code>~~~\nTokens:\n  0: systemd-fido2\n        fido2-credential:\n                    98 9b 58 d4 52 08 4f 1b 65 2a e9 c7 86 6b 45 ba\n                    66 3b c1 7f cb d4 39 0b e4 5e 3b 4b ea 36 5d 0e\n                    7c b8 50 38 a2 5a 31 09 d7 91 1e cd 78 46 4c cb\n                    fc 6f 51 ee da b5 61 79 44 07 82 2a 56 92 ad bf\n                    2d cb cc 53 1b c6 70 8b 57 4b 9f 75 59 60 be 54\n                    21 cf 89 b0 f5 1b 28 8e 2f 3c 5d 44 f5 5e 7c da\n        fido2-salt: 4a f5 09 cf a8 84 66 f5 9e e4 3e 6e c3 19 1a a1\n                    7e 52 d5 e3 ef cd 45 bd e3 60 02 09 94 45 ea 00\n        fido2-rp:   io.systemd.cryptsetup\n        fido2-clientPin-required:\n                    true\n        fido2-up-required:\n                    true\n        fido2-uv-required:\n                    false\n        Keyslot:    1\n~~~\n</code></pre>"},{"location":"LUKS-Fido2/#edit-etccrypttab","title":"Edit /etc/crypttab","text":"<p>Next step is to add <code>,fido2-device=auto</code> to file <code>/etc/crypttab</code></p> Content of '/etc/crypttab'<pre><code>nimda@trixie:~$ cat /etc/crypttab \nvda5_crypt UUID=fb3239d3-be24-446e-b956-8fe4aea8f34c none luks,discard,x-initrd.attach,fido2-device=auto\nnimda@trixie:~$\n</code></pre>"},{"location":"LUKS-Fido2/#initramfs","title":"initramfs","text":"<p>As the tool <code>initramfs</code> has a bug not recognizing the option we added, we need to install <code>dracut</code></p>"},{"location":"LUKS-Fido2/#dracut","title":"dracut","text":"<p>Create config file for <code>dracut</code></p> 'dracut' config<pre><code>sudo mkdir /etc/dracut.conf.d\necho 'hostonly=\"yes\"' | sudo tee /etc/dracut.conf.d/hostonly.conf\n</code></pre> Install 'dracut'<pre><code>sudo apt install dracut\n</code></pre> <p>After installation we need to recreate the 'initramfs'</p> Recreate 'initramfs'<pre><code>sudo dracut -f\n</code></pre>"},{"location":"code-examples/","title":"Code examples","text":""},{"location":"code-examples/#an-example-of-codeblock-in-python","title":"An example of codeblock in python","text":"Add numbers.py<pre><code># Function to add two numbers\ndef add_two_numbers(num1, num2):\n    return num1 + num2\n\n# Example usage\nresult = add_two_numbers(5, 3)\nprint('The sum is:', result)\n</code></pre> Test<pre><code>nimda@trixie:~$ lsblk\n\nNAME                    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINTS\nsr0                      11:0    1  3,7G  0 rom   \nvda                     254:0    0   20G  0 disk  \n\u251c\u2500vda1                  254:1    0  966M  0 part  /boot\n\u251c\u2500vda2                  254:2    0    1K  0 part  \n\u2514\u2500vda5                  254:5    0 19,1G  0 part  \n  \u2514\u2500vda5_crypt          253:0    0   19G  0 crypt \n    \u251c\u2500trixie--vg-root   253:1    0   18G  0 lvm   /\n    \u2514\u2500trixie--vg-swap_1 253:2    0    1G  0 lvm   [SWAP]\n</code></pre>"}]}